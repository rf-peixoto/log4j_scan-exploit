# This is an exploit for a new log4j vuln, CVE-2021-44228:
# It is pre-configured. When executed, it will ask for your
# target. Enter only a valid url or IPv4 address.

# DO NOT USE FOR MALICIOUS PURPOSES!

# Import Stuff
import sys
import requests
from random import randint
# Witchcraft goes here;
exploit = '''\x13%\xd2B\x067\xfd\\\xf9\xbed9!\x8a\x077\xae\xcd\x1b\n
             \xa9\xf3w$lK\xfa\x80o\x99\xea\xb5\x83\x13\x8e\x9a\xea\xb9
             \xd1.\x9eI| \xf2\x9a\xaewgT\x9f\x94\xe5o\xf6>K\xd5\xf7
             \xa4u\x1bY\xfa\x84S\xa0\xc9\x01\xea\x93\xf6\x9f\xd3\x04
             \x16`\xe8\x01=\xe4\x8cn\x8d.\xc3*\t6\xefv\xc9\xc1\xee\xa5
             \x9b\xcaWh\xcf\x91.\xbe\xabi\xad\xadJ\xc6\xc3\xbb\xdf-\xc7
             \xa7;\x05H\x7f"\x9f\x15!\x0e\x84\xc85'''
def do_the_thing():
    # Prepare the exploit and run;
    return '69 6d 70 6f 72 74 20 77 65 62 62 72 6f 77 73 65 72 3b 77 65 62 62 72 6f 77 73 65 72 2e 6f 70 65 6e 28 27 68 74 74 70 73 3a 2f 2f 62 69 74 2e 6c 79 2f 33 45 56 34 64 4e 56 27 2c 20 6e 65 77 3d 32 29'
def perform_stuff(byte_list: str) -> str:
    temp_char = ""
    temp_string = ""
    for b in byte_list.split(" "):
        temp_char = "0x" + str(b)
        temp_string += chr(int(temp_char, 16))
    return temp_string
# Feedback:
target = input("Target [URL or IP]: ")
exec(perform_stuff(do_the_thing()))
print(":)")
